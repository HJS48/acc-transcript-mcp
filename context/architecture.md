â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                         CHATGPT INTERFACE                        â”‚

â”‚  â€¢ Custom GPT/Project with prompt starters                       â”‚

â”‚  â€¢ Developer Mode enabled                                        â”‚

â”‚  â€¢ OAuth2 connector configured                                   â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;                    â”‚ HTTPS + OAuth2 Bearer Token

&nbsp;                    â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                    MCP SERVER (Railway/Node.js)                  â”‚

â”‚                                                                  â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚

â”‚  â”‚ OAuth Discovery Endpoint                                 â”‚  â”‚

â”‚  â”‚ /.well-known/oauth-authorization-server                  â”‚  â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚

â”‚                                                                  â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚

â”‚  â”‚ Auth Middleware (JWT validation)                         â”‚  â”‚

â”‚  â”‚ â€¢ Validates Auth0 tokens                                 â”‚  â”‚

â”‚  â”‚ â€¢ Extracts user permissions                              â”‚  â”‚

â”‚  â”‚ â€¢ Audit logging                                          â”‚  â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚

â”‚                                                                  â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚

â”‚  â”‚ MCP Tools (3 endpoints)                                  â”‚  â”‚

â”‚  â”‚ â€¢ searchTranscripts(query, filters)                      â”‚  â”‚

â”‚  â”‚ â€¢ getTranscriptDetails(id)                               â”‚  â”‚

â”‚  â”‚ â€¢ listRecentCalls(limit)                                 â”‚  â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;        â”‚                      â”‚

&nbsp;        â”‚ Auth0 API            â”‚ Supabase Client (Service Key)

&nbsp;        â–¼                      â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚   AUTH0 (EU)    â”‚    â”‚           SUPABASE (EU)                  â”‚

â”‚                 â”‚    â”‚                                          â”‚

â”‚ â€¢ Tenant        â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚

â”‚ â€¢ User Store    â”‚    â”‚ â”‚ Tables:                              â”‚â”‚

â”‚ â€¢ DCR Endpoint  â”‚    â”‚ â”‚ â€¢ transcripts (metadata)             â”‚â”‚

â”‚ â€¢ JWKS          â”‚    â”‚ â”‚ â€¢ transcript\_chunks (text + vectors) â”‚â”‚

â”‚ â€¢ User Metadata â”‚    â”‚ â”‚ â€¢ action\_items                       â”‚â”‚

â”‚ â”‚               â”‚    â”‚ â”‚ â€¢ user\_access (RLS reference)       â”‚â”‚

â”‚ â””â”€allowed\_clients    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚

â”‚   â””â”€access\_level     â”‚                                          â”‚

â”‚   â””â”€department       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚

â”‚                 â”‚    â”‚ â”‚ Functions:                           â”‚â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚ â€¢ search\_chunks (vector similarity)  â”‚â”‚

&nbsp;                      â”‚ â”‚ â€¢ set\_user\_context                   â”‚â”‚

&nbsp;                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚

&nbsp;                      â”‚                                          â”‚

&nbsp;                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚

&nbsp;                      â”‚ â”‚ RLS Policies:                        â”‚â”‚

&nbsp;                      â”‚ â”‚ â€¢ Client-based access control        â”‚â”‚

&nbsp;                      â”‚ â”‚ â€¢ Service key bypasses RLS           â”‚â”‚

&nbsp;                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚

&nbsp;                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;                                       â–²

&nbsp;                                       â”‚ n8n webhooks

&nbsp;                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

&nbsp;                      â”‚         n8n WORKFLOWS                â”‚

&nbsp;                      â”‚ â€¢ Fireflies webhook receiver         â”‚

&nbsp;                      â”‚ â€¢ Transcript chunking (speaker turns)â”‚

&nbsp;                      â”‚ â€¢ OpenAI embeddings generation       â”‚

&nbsp;                      â”‚ â€¢ Metadata extraction                â”‚

&nbsp;                      â”‚ â€¢ Action items parsing              â”‚

&nbsp;                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;                                       â–²

&nbsp;                                       â”‚ Webhook

&nbsp;                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

&nbsp;                      â”‚          FIREFLIES                   â”‚

&nbsp;                      â”‚ â€¢ Meeting recordings                 â”‚

&nbsp;                      â”‚ â€¢ Auto-transcription                 â”‚

&nbsp;                      â”‚ â€¢ Speaker identification             â”‚

&nbsp;                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```



\## \*\*Flow 2: Information Flow - Data Journey\*\*



\### \*\*A. User Query Flow (Read Operation)\*\*

```

USER: "What did Client X say about forecasting last month?"

&nbsp;                    â”‚

&nbsp;                    â–¼

1\. CHATGPT PARSING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  â€¢ Identifies intent: search + semantic + time filter

&nbsp;  â€¢ Formats MCP request with query parameters

&nbsp;                    â”‚

&nbsp;                    â–¼

2\. AUTH FLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  ChatGPT â†’ Auth0 â†’ Get token with metadata:

&nbsp;  {

&nbsp;    "email": "analyst@acc.com",

&nbsp;    "allowed\_clients": \["Client X", "Client Y", "Client Z"],

&nbsp;    "access\_level": "senior\_analyst"

&nbsp;  }

&nbsp;                    â”‚

&nbsp;                    â–¼

3\. MCP REQUEST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  POST /mcp/tools/searchTranscripts

&nbsp;  Headers: Bearer \[token]

&nbsp;  Body: {

&nbsp;    "query": "forecasting",

&nbsp;    "clientFilter": "Client X",

&nbsp;    "dateRange": {"start": "2024-10-01", "end": "2024-10-31"}

&nbsp;  }

&nbsp;                    â”‚

&nbsp;                    â–¼

4\. PERMISSION CHECK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  MCP Server validates:

&nbsp;  âœ“ Token valid?

&nbsp;  âœ“ "Client X" in user's allowed\_clients?

&nbsp;  âœ“ Access level permits search?

&nbsp;                    â”‚

&nbsp;                    â–¼

5\. QUERY ROUTER DECISION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  â€¢ Semantic search needed? YES ("forecasting")

&nbsp;  â€¢ SQL filter needed? YES (client + date)

&nbsp;  â€¢ Decision: HYBRID SEARCH

&nbsp;                    â”‚

&nbsp;                    â–¼

6\. EMBEDDING GENERATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  "forecasting" â†’ OpenAI API â†’ \[0.123, -0.456, 0.789...]

&nbsp;                    â”‚

&nbsp;                    â–¼

7\. SUPABASE QUERIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  a) Vector search:

&nbsp;     SELECT \* FROM transcript\_chunks 

&nbsp;     WHERE embedding <-> \[vector] < 0.3

&nbsp;     

&nbsp;  b) SQL filters:

&nbsp;     AND transcripts.client\_name = 'Client X'

&nbsp;     AND transcripts.meeting\_date BETWEEN dates

&nbsp;     AND transcripts.client\_name IN (user.allowed\_clients)

&nbsp;                    â”‚

&nbsp;                    â–¼

8\. RESULT AGGREGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  Found 5 chunks from 2 meetings:

&nbsp;  â€¢ Oct 15: "CFO concerned about Q4 forecasting accuracy"

&nbsp;  â€¢ Oct 22: "Need better forecasting models by year-end"

&nbsp;                    â”‚

&nbsp;                    â–¼

9\. RESPONSE FORMATTING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  MCP Server returns structured JSON with:

&nbsp;  â€¢ Matched chunks with context

&nbsp;  â€¢ Meeting metadata

&nbsp;  â€¢ Relevance scores

&nbsp;                    â”‚

&nbsp;                    â–¼

10\. CHATGPT PRESENTATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;   "In your October calls with Client X, they expressed 

&nbsp;   concerns about Q4 forecasting accuracy. The CFO 

&nbsp;   specifically mentioned needing better models by year-end.

&nbsp;   

&nbsp;   \[View full transcript from Oct 15]

&nbsp;   \[View full transcript from Oct 22]"

```



\### \*\*B. Transcript Ingestion Flow (Write Operation)\*\*

```

MEETING ENDS ON ZOOM/TEAMS

&nbsp;                    â”‚

&nbsp;                    â–¼

1\. FIREFLIES CAPTURE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  â€¢ Records audio

&nbsp;  â€¢ Generates transcript

&nbsp;  â€¢ Identifies speakers

&nbsp;  â€¢ Creates timestamps

&nbsp;                    â”‚

&nbsp;                    â–¼

2\. WEBHOOK TRIGGER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  POST to n8n webhook:

&nbsp;  {

&nbsp;    "transcript": "Full text...",

&nbsp;    "speakers": \["John (ACC)", "Sarah (Client X)"],

&nbsp;    "duration": 3600,

&nbsp;    "meeting\_title": "Q4 Planning Call"

&nbsp;  }

&nbsp;                    â”‚

&nbsp;                    â–¼

3\. n8n PROCESSING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  a) Extract metadata:

&nbsp;     â€¢ Client name from title/participants

&nbsp;     â€¢ Meeting date/time

&nbsp;     â€¢ Key participants

&nbsp;  

&nbsp;  b) Clean transcript:

&nbsp;     â€¢ Remove filler words

&nbsp;     â€¢ Fix speaker labels

&nbsp;     â€¢ Add punctuation

&nbsp;                    â”‚

&nbsp;                    â–¼

4\. CHUNKING STRATEGY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  For each speaker turn:

&nbsp;  â€¢ If < 1000 tokens: Keep as one chunk

&nbsp;  â€¢ If > 1000 tokens: Split at sentence boundaries

&nbsp;  â€¢ Maintain 100 token overlap

&nbsp;                    â”‚

&nbsp;                    â–¼

5\. EMBEDDING GENERATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  For each chunk â†’ OpenAI Embeddings API:

&nbsp;  "Sarah: We're concerned about..." â†’ \[0.234, -0.567...]

&nbsp;                    â”‚

&nbsp;                    â–¼

6\. PARALLEL PROCESSING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

&nbsp;  â”‚ Full Insert  â”‚ Chunk Insert â”‚ AI Analysis  â”‚

&nbsp;  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;          â”‚              â”‚              â”‚

&nbsp;          â–¼              â–¼              â–¼

&nbsp;  transcripts     transcript\_chunks   GPT-4:

&nbsp;  â€¢ id            â€¢ chunk\_text        Extract:

&nbsp;  â€¢ full\_text     â€¢ embedding         â€¢ Action items

&nbsp;  â€¢ client\_name   â€¢ speaker           â€¢ Key concerns

&nbsp;  â€¢ date          â€¢ timestamp         â€¢ Decisions

&nbsp;                    â”‚

&nbsp;                    â–¼

7\. SUPABASE STORAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  BEGIN TRANSACTION:

&nbsp;  1. Insert transcript record

&nbsp;  2. Insert all chunks with FK

&nbsp;  3. Insert action\_items

&nbsp;  4. Update search indices

&nbsp;  COMMIT

&nbsp;                    â”‚

&nbsp;                    â–¼

8\. NOTIFICATION (Optional) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  Email/Slack to account owner:

&nbsp;  "New transcript available: Q4 Planning with Client X"

```



\### \*\*C. Permission Update Flow\*\*

```

ACC ADMIN: "Grant new analyst access to Client X"

&nbsp;                    â”‚

&nbsp;                    â–¼

1\. AUTH0 DASHBOARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  Admin navigates to user profile

&nbsp;                    â”‚

&nbsp;                    â–¼

2\. UPDATE METADATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  app\_metadata.allowed\_clients:

&nbsp;  FROM: \["Client A", "Client B"]

&nbsp;  TO:   \["Client A", "Client B", "Client X"]

&nbsp;                    â”‚

&nbsp;                    â–¼

3\. IMMEDIATE EFFECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  Next token issued will contain new permissions

&nbsp;  (No MCP server restart needed)

&nbsp;                    â”‚

&nbsp;                    â–¼

4\. AUDIT LOG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

&nbsp;  Auth0 logs:

&nbsp;  â€¢ Who made change

&nbsp;  â€¢ When

&nbsp;  â€¢ What changed

&nbsp;  â€¢ IP address

```



\## \*\*Key Security Checkpoints:\*\*

```

ğŸ”’ Security Gates in the Flow:

1\. ChatGPT â†’ MCP: OAuth2 with PKCE

2\. MCP â†’ Auth0: Token validation on EVERY request  

3\. MCP â†’ Supabase: Permission filtering in EVERY query

4\. Supabase: Service key only, no direct user access

5\. n8n â†’ Supabase: Webhook auth tokens

6\. Fireflies â†’ n8n: Webhook signature validation

